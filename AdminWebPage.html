<!doctype html>
<html lang="es" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Portal Administrador - Intercambio de Regalos</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="/_sdk/data_sdk.js"></script>
  <style>
        body {
            box-sizing: border-box;
            position: relative;
        }
        
        body::before {
            content: '';
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 40%;
            background: linear-gradient(to top, rgba(194, 65, 12, 0.15) 0%, transparent 100%);
            z-index: 0;
            pointer-events: none;
        }
        
        .christmas-city {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 35%;
            z-index: 1;
            pointer-events: none;
            display: flex;
            justify-content: space-around;
            align-items: flex-end;
            padding: 0 5%;
            opacity: 0.3;
        }
        
        .building {
            display: flex;
            flex-direction: column;
            align-items: center;
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.1));
        }
        
        .building-body {
            background: linear-gradient(135deg, #92400e 0%, #c2410c 100%);
            border-radius: 8px 8px 0 0;
            position: relative;
        }
        
        .building-windows {
            position: absolute;
            top: 10%;
            left: 0;
            right: 0;
            height: 80%;
            display: flex;
            flex-direction: column;
            justify-content: space-around;
            padding: 5px;
        }
        
        .window-row {
            display: flex;
            justify-content: space-around;
        }
        
        .window {
            width: 8px;
            height: 8px;
            background: #fbbf24;
            border-radius: 1px;
            box-shadow: 0 0 5px #fbbf24;
        }
        
        .forest {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 25%;
            z-index: 2;
            pointer-events: none;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            opacity: 0.4;
            padding: 0 2%;
        }
        
        .tree {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0 -10px;
        }
        
        .tree-top {
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-bottom: 35px solid #065f46;
            position: relative;
        }
        
        .tree-top::after {
            content: '';
            position: absolute;
            top: -8px;
            left: -20px;
            width: 40px;
            height: 12px;
            background: white;
            border-radius: 50%;
            opacity: 0.9;
        }
        
        .tree-middle {
            width: 0;
            height: 0;
            border-left: 25px solid transparent;
            border-right: 25px solid transparent;
            border-bottom: 40px solid #047857;
            margin-top: -15px;
            position: relative;
        }
        
        .tree-middle::after {
            content: '';
            position: absolute;
            top: -5px;
            left: -25px;
            width: 50px;
            height: 10px;
            background: white;
            border-radius: 50%;
            opacity: 0.8;
        }
        
        .tree-bottom {
            width: 0;
            height: 0;
            border-left: 30px solid transparent;
            border-right: 30px solid transparent;
            border-bottom: 45px solid #059669;
            margin-top: -15px;
            position: relative;
        }
        
        .tree-bottom::after {
            content: '';
            position: absolute;
            top: 0px;
            left: -30px;
            width: 60px;
            height: 8px;
            background: white;
            border-radius: 50%;
            opacity: 0.7;
        }
        
        .tree-trunk {
            width: 10px;
            height: 15px;
            background: #78350f;
            margin-top: -5px;
        }
        
        .tree.small .tree-top {
            border-left-width: 12px;
            border-right-width: 12px;
            border-bottom-width: 20px;
        }
        
        .tree.small .tree-top::after {
            width: 24px;
            left: -12px;
            height: 8px;
        }
        
        .tree.small .tree-middle {
            border-left-width: 15px;
            border-right-width: 15px;
            border-bottom-width: 25px;
        }
        
        .tree.small .tree-middle::after {
            width: 30px;
            left: -15px;
            height: 6px;
        }
        
        .tree.small .tree-bottom {
            border-left-width: 18px;
            border-right-width: 18px;
            border-bottom-width: 30px;
        }
        
        .tree.small .tree-bottom::after {
            width: 36px;
            left: -18px;
            height: 5px;
        }
        
        .tree.small .tree-trunk {
            width: 6px;
            height: 10px;
        }
        
        .tree.large .tree-top {
            border-left-width: 28px;
            border-right-width: 28px;
            border-bottom-width: 50px;
        }
        
        .tree.large .tree-top::after {
            width: 56px;
            left: -28px;
            height: 15px;
        }
        
        .tree.large .tree-middle {
            border-left-width: 35px;
            border-right-width: 35px;
            border-bottom-width: 60px;
        }
        
        .tree.large .tree-middle::after {
            width: 70px;
            left: -35px;
            height: 12px;
        }
        
        .tree.large .tree-bottom {
            border-left-width: 42px;
            border-right-width: 42px;
            border-bottom-width: 70px;
        }
        
        .tree.large .tree-bottom::after {
            width: 84px;
            left: -42px;
            height: 10px;
        }
        
        .tree.large .tree-trunk {
            width: 14px;
            height: 20px;
        }
        
        .garland-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 150px;
            z-index: 3;
            pointer-events: none;
            overflow: visible;
        }
        
        .garland-strand {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 100%;
        }
        
        .garland-branch {
            position: absolute;
            width: 8px;
            background: linear-gradient(180deg, #065f46 0%, #047857 50%, #059669 100%);
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .garland-branch::before,
        .garland-branch::after {
            content: '';
            position: absolute;
            width: 12px;
            height: 3px;
            background: #065f46;
            border-radius: 2px;
        }
        
        .garland-branch::before {
            top: 20%;
            left: -6px;
            transform: rotate(-30deg);
        }
        
        .garland-branch::after {
            top: 50%;
            right: -6px;
            transform: rotate(30deg);
        }
        
        .light {
            position: absolute;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            animation: twinkle 2s infinite;
        }
        
        .light::before {
            content: '';
            position: absolute;
            top: -3px;
            left: 50%;
            transform: translateX(-50%);
            width: 2px;
            height: 8px;
            background: #1f2937;
            border-radius: 1px;
        }
        
        .light.red {
            background: radial-gradient(circle, #fca5a5 0%, #ef4444 100%);
            box-shadow: 0 0 15px #ef4444, 0 0 5px #ef4444;
        }
        
        .light.yellow {
            background: radial-gradient(circle, #fde68a 0%, #fbbf24 100%);
            box-shadow: 0 0 15px #fbbf24, 0 0 5px #fbbf24;
            animation-delay: 0.5s;
        }
        
        .light.blue {
            background: radial-gradient(circle, #93c5fd 0%, #3b82f6 100%);
            box-shadow: 0 0 15px #3b82f6, 0 0 5px #3b82f6;
            animation-delay: 1s;
        }
        
        .light.green {
            background: radial-gradient(circle, #6ee7b7 0%, #10b981 100%);
            box-shadow: 0 0 15px #10b981, 0 0 5px #10b981;
            animation-delay: 1.5s;
        }
        
        .light.pink {
            background: radial-gradient(circle, #fbcfe8 0%, #ec4899 100%);
            box-shadow: 0 0 15px #ec4899, 0 0 5px #ec4899;
            animation-delay: 0.75s;
        }
        
        .light.orange {
            background: radial-gradient(circle, #fed7aa 0%, #f97316 100%);
            box-shadow: 0 0 15px #f97316, 0 0 5px #f97316;
            animation-delay: 1.25s;
        }
        
        @keyframes twinkle {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.4; transform: scale(0.8); }
        }
        
        .snowflake {
            position: fixed;
            top: -10px;
            z-index: 9999;
            user-select: none;
            cursor: default;
            animation: snowfall linear infinite;
            color: white;
            text-shadow: 0 0 5px rgba(255,255,255,0.8);
            pointer-events: none;
        }
        
        @keyframes snowfall {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 0.8;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0.3;
            }
        }
        
        .snowflake:nth-child(1) { left: 10%; animation-duration: 8s; animation-delay: 0s; font-size: 1.2em; }
        .snowflake:nth-child(2) { left: 20%; animation-duration: 10s; animation-delay: 1s; font-size: 0.8em; }
        .snowflake:nth-child(3) { left: 30%; animation-duration: 12s; animation-delay: 2s; font-size: 1em; }
        .snowflake:nth-child(4) { left: 40%; animation-duration: 9s; animation-delay: 0.5s; font-size: 1.3em; }
        .snowflake:nth-child(5) { left: 50%; animation-duration: 11s; animation-delay: 1.5s; font-size: 0.9em; }
        .snowflake:nth-child(6) { left: 60%; animation-duration: 10s; animation-delay: 2.5s; font-size: 1.1em; }
        .snowflake:nth-child(7) { left: 70%; animation-duration: 13s; animation-delay: 0.8s; font-size: 0.85em; }
        .snowflake:nth-child(8) { left: 80%; animation-duration: 9s; animation-delay: 1.8s; font-size: 1.2em; }
        .snowflake:nth-child(9) { left: 90%; animation-duration: 11s; animation-delay: 2.2s; font-size: 0.95em; }
        .snowflake:nth-child(10) { left: 15%; animation-duration: 12s; animation-delay: 0.3s; font-size: 1em; }
        .snowflake:nth-child(11) { left: 25%; animation-duration: 10s; animation-delay: 1.2s; font-size: 0.9em; }
        .snowflake:nth-child(12) { left: 35%; animation-duration: 11s; animation-delay: 2.8s; font-size: 1.15em; }
        .snowflake:nth-child(13) { left: 45%; animation-duration: 9s; animation-delay: 0.6s; font-size: 0.85em; }
        .snowflake:nth-child(14) { left: 55%; animation-duration: 13s; animation-delay: 1.9s; font-size: 1.1em; }
        .snowflake:nth-child(15) { left: 65%; animation-duration: 10s; animation-delay: 2.3s; font-size: 0.95em; }
        .snowflake:nth-child(16) { left: 75%; animation-duration: 12s; animation-delay: 0.9s; font-size: 1.25em; }
        .snowflake:nth-child(17) { left: 85%; animation-duration: 11s; animation-delay: 1.6s; font-size: 0.88em; }
        .snowflake:nth-child(18) { left: 95%; animation-duration: 9s; animation-delay: 2.7s; font-size: 1.05em; }
        .snowflake:nth-child(19) { left: 5%; animation-duration: 10s; animation-delay: 0.4s; font-size: 0.92em; }
        .snowflake:nth-child(20) { left: 33%; animation-duration: 13s; animation-delay: 1.4s; font-size: 1.18em; }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .shake-animation {
            animation: shake 0.5s ease-in-out;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
        
        .pulse-glow {
            animation: pulseGlow 2s infinite;
        }
        
        @keyframes pulseGlow {
            0%, 100% {
                box-shadow: 0 0 20px rgba(251, 146, 60, 0.5);
            }
            50% {
                box-shadow: 0 0 40px rgba(251, 146, 60, 0.8);
            }
        }
        
        .admin-card {
            background: linear-gradient(135deg, #fb923c 0%, #f97316 100%);
            box-shadow: 0 25px 50px rgba(251, 146, 60, 0.5);
        }
        
        .spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 0.8s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
 </head>
 <body class="h-full bg-gradient-to-br from-orange-50 via-amber-50 to-yellow-50 font-sans relative"><!-- Christmas Garland -->
  <div class="garland-container">
   <div class="garland-strand" id="garland-strand"></div>
  </div><!-- Christmas City Background -->
  <div class="christmas-city">
   <div class="building">
    <div class="text-3xl">
     ‚≠ê
    </div>
    <div class="building-body" style="width: 60px; height: 120px;">
     <div class="building-windows">
      <div class="window-row">
       <div class="window"></div>
       <div class="window"></div>
       <div class="window"></div>
      </div>
      <div class="window-row">
       <div class="window"></div>
       <div class="window"></div>
       <div class="window"></div>
      </div>
      <div class="window-row">
       <div class="window"></div>
       <div class="window"></div>
       <div class="window"></div>
      </div>
     </div>
    </div>
   </div>
   <div class="building">
    <div class="text-2xl">
     üéÑ
    </div>
    <div class="building-body" style="width: 50px; height: 90px;">
     <div class="building-windows">
      <div class="window-row">
       <div class="window"></div>
       <div class="window"></div>
      </div>
      <div class="window-row">
       <div class="window"></div>
       <div class="window"></div>
      </div>
      <div class="window-row">
       <div class="window"></div>
       <div class="window"></div>
      </div>
     </div>
    </div>
   </div>
   <div class="building">
    <div class="text-3xl">
     ‚ú®
    </div>
    <div class="building-body" style="width: 70px; height: 140px;">
     <div class="building-windows">
      <div class="window-row">
       <div class="window"></div>
       <div class="window"></div>
       <div class="window"></div>
       <div class="window"></div>
      </div>
      <div class="window-row">
       <div class="window"></div>
       <div class="window"></div>
       <div class="window"></div>
       <div class="window"></div>
      </div>
      <div class="window-row">
       <div class="window"></div>
       <div class="window"></div>
       <div class="window"></div>
       <div class="window"></div>
      </div>
     </div>
    </div>
   </div>
   <div class="building">
    <div class="text-2xl">
     üåü
    </div>
    <div class="building-body" style="width: 55px; height: 100px;">
     <div class="building-windows">
      <div class="window-row">
       <div class="window"></div>
       <div class="window"></div>
      </div>
      <div class="window-row">
       <div class="window"></div>
       <div class="window"></div>
      </div>
      <div class="window-row">
       <div class="window"></div>
       <div class="window"></div>
      </div>
     </div>
    </div>
   </div>
   <div class="building">
    <div class="text-3xl">
     üéÑ
    </div>
    <div class="building-body" style="width: 65px; height: 130px;">
     <div class="building-windows">
      <div class="window-row">
       <div class="window"></div>
       <div class="window"></div>
       <div class="window"></div>
      </div>
      <div class="window-row">
       <div class="window"></div>
       <div class="window"></div>
       <div class="window"></div>
      </div>
      <div class="window-row">
       <div class="window"></div>
       <div class="window"></div>
       <div class="window"></div>
      </div>
     </div>
    </div>
   </div>
   <div class="building">
    <div class="text-2xl">
     ‚≠ê
    </div>
    <div class="building-body" style="width: 50px; height: 95px;">
     <div class="building-windows">
      <div class="window-row">
       <div class="window"></div>
       <div class="window"></div>
      </div>
      <div class="window-row">
       <div class="window"></div>
       <div class="window"></div>
      </div>
      <div class="window-row">
       <div class="window"></div>
       <div class="window"></div>
      </div>
     </div>
    </div>
   </div>
  </div><!-- Forest Background -->
  <div class="forest">
   <div class="tree large">
    <div class="tree-top"></div>
    <div class="tree-middle"></div>
    <div class="tree-bottom"></div>
    <div class="tree-trunk"></div>
   </div>
   <div class="tree small">
    <div class="tree-top"></div>
    <div class="tree-middle"></div>
    <div class="tree-bottom"></div>
    <div class="tree-trunk"></div>
   </div>
   <div class="tree">
    <div class="tree-top"></div>
    <div class="tree-middle"></div>
    <div class="tree-bottom"></div>
    <div class="tree-trunk"></div>
   </div>
   <div class="tree small">
    <div class="tree-top"></div>
    <div class="tree-middle"></div>
    <div class="tree-bottom"></div>
    <div class="tree-trunk"></div>
   </div>
   <div class="tree large">
    <div class="tree-top"></div>
    <div class="tree-middle"></div>
    <div class="tree-bottom"></div>
    <div class="tree-trunk"></div>
   </div>
   <div class="tree">
    <div class="tree-top"></div>
    <div class="tree-middle"></div>
    <div class="tree-bottom"></div>
    <div class="tree-trunk"></div>
   </div>
   <div class="tree small">
    <div class="tree-top"></div>
    <div class="tree-middle"></div>
    <div class="tree-bottom"></div>
    <div class="tree-trunk"></div>
   </div>
   <div class="tree large">
    <div class="tree-top"></div>
    <div class="tree-middle"></div>
    <div class="tree-bottom"></div>
    <div class="tree-trunk"></div>
   </div>
   <div class="tree">
    <div class="tree-top"></div>
    <div class="tree-middle"></div>
    <div class="tree-bottom"></div>
    <div class="tree-trunk"></div>
   </div>
   <div class="tree small">
    <div class="tree-top"></div>
    <div class="tree-middle"></div>
    <div class="tree-bottom"></div>
    <div class="tree-trunk"></div>
   </div>
   <div class="tree">
    <div class="tree-top"></div>
    <div class="tree-middle"></div>
    <div class="tree-bottom"></div>
    <div class="tree-trunk"></div>
   </div>
   <div class="tree large">
    <div class="tree-top"></div>
    <div class="tree-middle"></div>
    <div class="tree-bottom"></div>
    <div class="tree-trunk"></div>
   </div>
   <div class="tree small">
    <div class="tree-top"></div>
    <div class="tree-middle"></div>
    <div class="tree-bottom"></div>
    <div class="tree-trunk"></div>
   </div>
   <div class="tree">
    <div class="tree-top"></div>
    <div class="tree-middle"></div>
    <div class="tree-bottom"></div>
    <div class="tree-trunk"></div>
   </div>
   <div class="tree small">
    <div class="tree-top"></div>
    <div class="tree-middle"></div>
    <div class="tree-bottom"></div>
    <div class="tree-trunk"></div>
   </div>
  </div><!-- Snowflakes Animation -->
  <div class="snowflake">
   ‚ùÑÔ∏è
  </div>
  <div class="snowflake">
   ‚ùÖ
  </div>
  <div class="snowflake">
   ‚ùÜ
  </div>
  <div class="snowflake">
   ‚ùÑÔ∏è
  </div>
  <div class="snowflake">
   ‚ùÖ
  </div>
  <div class="snowflake">
   ‚ùÜ
  </div>
  <div class="snowflake">
   ‚ùÑÔ∏è
  </div>
  <div class="snowflake">
   ‚ùÖ
  </div>
  <div class="snowflake">
   ‚ùÜ
  </div>
  <div class="snowflake">
   ‚ùÑÔ∏è
  </div>
  <div class="snowflake">
   ‚ùÖ
  </div>
  <div class="snowflake">
   ‚ùÜ
  </div>
  <div class="snowflake">
   ‚ùÑÔ∏è
  </div>
  <div class="snowflake">
   ‚ùÖ
  </div>
  <div class="snowflake">
   ‚ùÜ
  </div>
  <div class="snowflake">
   ‚ùÑÔ∏è
  </div>
  <div class="snowflake">
   ‚ùÖ
  </div>
  <div class="snowflake">
   ‚ùÜ
  </div>
  <div class="snowflake">
   ‚ùÑÔ∏è
  </div>
  <div class="snowflake">
   ‚ùÖ
  </div>
  <div class="min-h-full flex flex-col relative" style="z-index: 10;"><!-- Login Section -->
   <div id="login-section" class="min-h-full flex items-center justify-center px-6 py-12">
    <div class="max-w-md w-full"><!-- Header -->
     <div class="text-center mb-8">
      <div class="inline-block text-8xl mb-4">
       üîß
      </div>
      <h1 id="admin-title" class="text-4xl font-bold text-gray-900 mb-2">Portal Administrador</h1>
      <h2 id="event-name" class="text-xl text-gray-600 mb-4">Intercambio Navide√±o 2025</h2><!-- Decorative elements -->
      <div class="flex justify-center items-center gap-2 mb-6"><span class="text-2xl animate-bounce">üéÅ</span> <span class="text-lg">„Éª</span> <span class="text-2xl animate-pulse">‚öôÔ∏è</span> <span class="text-lg">„Éª</span> <span class="text-2xl animate-bounce">üéÑ</span>
      </div>
     </div><!-- Login Card -->
     <div class="admin-card rounded-2xl p-8 text-white shadow-2xl">
      <div class="text-center mb-6">
       <div class="text-5xl mb-4">
        üîê
       </div>
       <h3 class="text-2xl font-bold mb-2">Acceso Administrador</h3>
       <p id="welcome-message" class="text-sm opacity-90">Gestiona tu intercambio de regalos</p>
      </div>
      <form id="admin-login-form" class="space-y-4">
       <div><label for="security-code" id="security-code-label" class="block text-sm font-medium mb-2 opacity-90">C√≥digo de Seguridad</label> <input type="password" id="security-code" name="security-code" required class="w-full px-4 py-3 rounded-lg bg-white bg-opacity-90 border border-white border-opacity-30 text-gray-800 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-white focus:ring-opacity-50 focus:bg-white" placeholder="Ingresa el c√≥digo">
       </div><button type="submit" id="admin-login-btn" class="w-full bg-white text-orange-600 font-bold py-3 px-6 rounded-lg transition-all duration-200 transform hover:scale-105 hover:shadow-lg"> <span class="flex items-center justify-center gap-2"> <span class="text-xl">üîß</span> <span>Acceder al Panel</span> </span> </button>
      </form><!-- Error Message -->
      <div id="error-message" class="mt-4 p-3 bg-red-500 bg-opacity-20 border border-red-300 border-opacity-30 rounded-lg text-center text-sm hidden"><span class="mr-2">‚ùå</span> <span>C√≥digo de seguridad incorrecto.</span>
      </div>
     </div><!-- Security Code Info -->
     <div class="mt-8 bg-white rounded-lg p-6 shadow-md">
      <div class="text-center">
       <div class="text-3xl mb-3">
        üîë
       </div>
       <h4 class="font-bold text-gray-800 mb-2">C√≥digo de Seguridad</h4>
       <div class="bg-orange-50 rounded-lg p-4 border-2 border-orange-300">
        <p class="text-2xl font-mono font-bold text-orange-600">ADMIN2025</p>
       </div>
       <p class="text-xs text-gray-500 mt-3">Usa este c√≥digo para acceder al panel de administraci√≥n</p>
      </div>
     </div><!-- Portal Navigation -->
     <div class="mt-6 text-center"><a href="#" onclick="switchToParticipantPortal()" class="inline-flex items-center gap-2 text-orange-600 hover:text-orange-800 transition-colors"> <span class="text-lg">üë§</span> <span class="text-sm font-medium">Ir al Portal Participantes</span> </a>
     </div>
    </div>
   </div><!-- Dashboard Section -->
   <div id="dashboard-section" class="hidden min-h-full flex flex-col"><!-- Header -->
    <header class="bg-gradient-to-r from-orange-600 to-amber-600 text-white shadow-lg">
     <div class="max-w-6xl mx-auto px-6 py-6">
      <div class="flex items-center justify-between">
       <div class="flex items-center">
        <div class="text-4xl mr-4">
         üîß
        </div>
        <div>
         <h1 class="text-3xl font-bold">Panel de Administraci√≥n</h1>
         <p class="text-lg opacity-90">Gestiona participantes y sorteos</p>
        </div>
       </div><button id="logout-btn" class="bg-gradient-to-r from-gray-700 to-gray-800 hover:from-gray-800 hover:to-gray-900 rounded-xl px-4 py-2 border-2 border-white shadow-lg transition-all duration-200 transform hover:scale-105"> <span class="flex items-center gap-2 text-sm text-white font-semibold"> <span>üö™</span> <span>Salir</span> </span> </button>
      </div><!-- Portal Navigation -->
      <div class="mt-4 pt-4 border-t border-white border-opacity-30">
       <div class="flex justify-center items-center gap-4">
        <div class="bg-gradient-to-r from-emerald-400 to-green-500 rounded-xl px-4 py-2 border-2 border-white shadow-lg">
         <div class="flex items-center gap-2 text-sm text-white font-semibold"><span class="text-lg">üîß</span> <span class="font-bold">Portal Administrador</span> <span class="text-xs bg-white text-green-700 px-2 py-0.5 rounded-full">Actual</span>
         </div>
        </div>
        <div class="text-white text-2xl">
         ‚ú®
        </div><a href="#" onclick="switchToParticipantPortal()" class="bg-gradient-to-r from-pink-400 to-red-500 hover:from-pink-500 hover:to-red-600 rounded-xl px-4 py-2 border-2 border-white shadow-lg transition-all duration-200 transform hover:scale-105">
         <div class="flex items-center gap-2 text-sm text-white font-semibold"><span class="text-lg">üë§</span> <span class="font-bold">Portal Participantes</span>
         </div></a>
       </div>
      </div>
     </div>
    </header><!-- Main Content -->
    <main class="flex-1 max-w-6xl mx-auto px-6 py-8 w-full"><!-- Stats Cards -->
     <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
      <div class="bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl p-6 text-white shadow-lg">
       <div class="flex items-center justify-between">
        <div>
         <p class="text-sm opacity-90 mb-1">Total Participantes</p>
         <p class="text-4xl font-bold" id="total-participants">0</p>
        </div>
        <div class="text-5xl opacity-80">
         üë•
        </div>
       </div>
      </div>
      <div class="bg-gradient-to-br from-green-500 to-green-600 rounded-xl p-6 text-white shadow-lg">
       <div class="flex items-center justify-between">
        <div>
         <p class="text-sm opacity-90 mb-1">Asignaciones</p>
         <p class="text-4xl font-bold" id="total-assignments">0</p>
        </div>
        <div class="text-5xl opacity-80">
         üéÅ
        </div>
       </div>
      </div>
      <div class="bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl p-6 text-white shadow-lg">
       <div class="flex items-center justify-between">
        <div>
         <p class="text-sm opacity-90 mb-1">Estado Sorteo</p>
         <p class="text-lg font-bold" id="draw-status">Sin Sortear</p>
        </div>
        <div class="text-5xl opacity-80">
         üé≤
        </div>
       </div>
      </div>
     </div><!-- Action Buttons -->
     <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8"><button id="add-participant-btn" class="bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-bold py-4 px-6 rounded-xl shadow-lg transition-all duration-200 transform hover:scale-105"> <span class="flex items-center justify-center gap-3"> <span class="text-2xl">‚ûï</span> <span class="text-lg">Agregar Participante</span> </span> </button> <button id="draw-btn" class="bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 text-white font-bold py-4 px-6 rounded-xl shadow-lg transition-all duration-200 transform hover:scale-105"> <span class="flex items-center justify-center gap-3"> <span class="text-2xl">üé≤</span> <span class="text-lg">Realizar Sorteo</span> </span> </button>
     </div><!-- Participants List -->
     <div class="bg-white rounded-xl shadow-lg p-6">
      <div class="flex items-center justify-between mb-6">
       <h3 class="text-2xl font-bold text-gray-800 flex items-center gap-2"><span class="text-3xl">üìã</span> <span>Lista de Participantes</span></h3>
      </div>
      <div id="participants-list" class="space-y-4"><!-- Participants will be rendered here -->
      </div>
      <div id="empty-state" class="text-center py-12">
       <div class="text-6xl mb-4">
        üìù
       </div>
       <h4 class="text-xl font-bold text-gray-700 mb-2">No hay participantes</h4>
       <p class="text-gray-500 mb-6">Comienza agregando el primer participante</p><button onclick="document.getElementById('add-participant-btn').click()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-lg transition-colors"> <span class="flex items-center justify-center gap-2"> <span>‚ûï</span> <span>Agregar Participante</span> </span> </button>
      </div>
     </div>
    </main><!-- Footer -->
    <footer class="bg-gray-800 text-white py-6">
     <div class="max-w-6xl mx-auto px-6 text-center">
      <div class="flex justify-center items-center gap-2 mb-2"><span class="animate-bounce">üîß</span> <span class="animate-pulse">üéÑ</span> <span class="animate-bounce">‚≠ê</span> <span class="animate-pulse">üéÅ</span> <span class="animate-bounce">üéâ</span>
      </div>
      <p class="text-gray-300">Portal de Administraci√≥n - Intercambio de Regalos 2025</p>
      <p class="text-xs text-gray-400 mt-1">Sistema de gesti√≥n completo</p>
     </div>
    </footer>
   </div>
  </div><!-- Add Participant Modal -->
  <div id="add-participant-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center px-4" style="z-index: 1000;">
   <div class="bg-white rounded-2xl p-8 max-w-md w-full shadow-2xl fade-in">
    <div class="flex items-center justify-between mb-6">
     <h3 class="text-2xl font-bold text-gray-800 flex items-center gap-2"><span class="text-3xl">üë§</span> <span>Nuevo Participante</span></h3><button id="close-modal-btn" class="text-gray-400 hover:text-gray-600 text-2xl">‚úï</button>
    </div>
    <form id="participant-form" class="space-y-4">
     <div><label for="name" class="block text-sm font-medium text-gray-700 mb-2">Nombre Completo</label> <input type="text" id="name" name="name" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Ej: Juan P√©rez">
     </div>
     <div><label for="email" class="block text-sm font-medium text-gray-700 mb-2">Email</label> <input type="email" id="email" name="email" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="juan@email.com">
     </div>
     <div><label for="phone" class="block text-sm font-medium text-gray-700 mb-2">Tel√©fono</label> <input type="tel" id="phone" name="phone" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="+51 999 999 999">
     </div>
     <div><label for="username" class="block text-sm font-medium text-gray-700 mb-2">Usuario</label> <input type="text" id="username" name="username" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="juan123">
     </div>
     <div><label for="password" class="block text-sm font-medium text-gray-700 mb-2">Contrase√±a</label> <input type="text" id="password-input" name="password" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Pass123">
     </div>
     <div class="flex gap-3 pt-4"><button type="button" id="cancel-btn" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 font-bold py-3 px-6 rounded-lg transition-colors"> Cancelar </button> <button type="submit" id="save-participant-btn" class="flex-1 bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-lg transition-colors"> <span class="flex items-center justify-center gap-2"> <span>üíæ</span> <span>Guardar</span> </span> </button>
     </div>
    </form>
   </div>
  </div>
  <script>
        // Configuration
        const defaultConfig = {
            admin_title: "Portal Administrador",
            event_name: "Intercambio Navide√±o 2025",
            welcome_message: "Gestiona tu intercambio de regalos",
            security_code_label: "C√≥digo de Seguridad",
            background_color: "#fffbeb",
            primary_color: "#fb923c",
            secondary_color: "#f97316",
            text_color: "#374151",
            surface_color: "#ffffff"
        };

        const ADMIN_CODE = "ADMIN2025";
        let allRecords = [];
        let participants = [];
        let isLoggedIn = false;
        let isDrawing = false;

        // Data SDK Handler
        const dataHandler = {
            onDataChanged(data) {
                allRecords = data || [];
                participants = allRecords.filter(r => r.recordType === 'participant');
                
                if (isLoggedIn) {
                    updateDashboard();
                    renderParticipantsList();
                }
            }
        };

        // Portal navigation
        function switchToParticipantPortal() {
            window.open('PARTICIPANT_PORTAL_URL', '_blank');
        }

        // Admin login handler
        document.getElementById('admin-login-form').addEventListener('submit', (e) => {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const code = formData.get('security-code').trim();
            
            if (code === ADMIN_CODE) {
                isLoggedIn = true;
                showDashboard();
                showToast("¬°Bienvenido Administrador!", "success");
            } else {
                showLoginError();
                showToast("C√≥digo de seguridad incorrecto.", "error");
            }
        });

        // Logout handler
        document.getElementById('logout-btn').addEventListener('click', () => {
            isLoggedIn = false;
            showLogin();
            showToast("Has cerrado sesi√≥n.", "info");
        });

        // Add participant button handler
        document.getElementById('add-participant-btn').addEventListener('click', () => {
            openAddParticipantModal();
        });

        // Draw button handler
        document.getElementById('draw-btn').addEventListener('click', async () => {
            if (participants.length < 2) {
                showToast("Necesitas al menos 2 participantes para realizar el sorteo.", "error");
                return;
            }
            
            if (hasAssignments()) {
                showConfirmModal(
                    "¬øRealizar nuevo sorteo?",
                    "Ya existe un sorteo realizado. ¬øDeseas crear uno nuevo? Esto eliminar√° las asignaciones actuales.",
                    async () => {
                        await performDraw();
                    }
                );
            } else {
                await performDraw();
            }
        });

        // Modal handlers
        document.getElementById('close-modal-btn').addEventListener('click', () => {
            closeAddParticipantModal();
        });

        document.getElementById('cancel-btn').addEventListener('click', () => {
            closeAddParticipantModal();
        });

        document.getElementById('add-participant-modal').addEventListener('click', (e) => {
            if (e.target.id === 'add-participant-modal') {
                closeAddParticipantModal();
            }
        });

        // Participant form handler
        document.getElementById('participant-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const participantData = {
                id: generateId(),
                name: formData.get('name').trim(),
                email: formData.get('email').trim(),
                phone: formData.get('phone').trim(),
                username: formData.get('username').trim(),
                password: formData.get('password').trim(),
                assignedTo: '',
                assignedToEmail: '',
                drawId: '',
                createdAt: new Date().toISOString(),
                recordType: 'participant'
            };
            
            // Check if username already exists
            if (participants.some(p => p.username === participantData.username)) {
                showToast("Este nombre de usuario ya est√° en uso.", "error");
                return;
            }
            
            // Check record limit
            if (allRecords.length >= 999) {
                showToast("L√≠mite de 999 registros alcanzado. Por favor elimina algunos registros primero.", "error");
                return;
            }
            
            // Show loading state
            const saveBtn = document.getElementById('save-participant-btn');
            const originalContent = saveBtn.innerHTML;
            saveBtn.disabled = true;
            saveBtn.innerHTML = '<div class="flex items-center justify-center gap-2"><div class="spinner"></div><span>Guardando...</span></div>';
            
            const result = await window.dataSdk.create(participantData);
            
            saveBtn.disabled = false;
            saveBtn.innerHTML = originalContent;
            
            if (result.isOk) {
                closeAddParticipantModal();
                showToast("Participante agregado exitosamente.", "success");
                document.getElementById('participant-form').reset();
            } else {
                showToast("Error al guardar el participante. Intenta nuevamente.", "error");
            }
        });

        // Show login
        function showLogin() {
            document.getElementById('login-section').classList.remove('hidden');
            document.getElementById('dashboard-section').classList.add('hidden');
            
            document.getElementById('admin-login-form').reset();
            document.getElementById('error-message').classList.add('hidden');
        }

        // Show dashboard
        function showDashboard() {
            document.getElementById('login-section').classList.add('hidden');
            document.getElementById('dashboard-section').classList.remove('hidden');
            
            updateDashboard();
            renderParticipantsList();
        }

        // Show login error
        function showLoginError() {
            const errorDiv = document.getElementById('error-message');
            const loginForm = document.getElementById('admin-login-form');
            
            errorDiv.classList.remove('hidden');
            loginForm.classList.add('shake-animation');
            
            setTimeout(() => {
                loginForm.classList.remove('shake-animation');
            }, 500);
        }

        // Update dashboard stats
        function updateDashboard() {
            document.getElementById('total-participants').textContent = participants.length;
            
            const assignedCount = participants.filter(p => p.assignedTo).length;
            document.getElementById('total-assignments').textContent = assignedCount;
            
            const statusElement = document.getElementById('draw-status');
            if (assignedCount > 0) {
                statusElement.textContent = 'Sorteado ‚úì';
                statusElement.parentElement.parentElement.classList.remove('from-purple-500', 'to-purple-600');
                statusElement.parentElement.parentElement.classList.add('from-green-500', 'to-green-600');
            } else {
                statusElement.textContent = 'Sin Sortear';
                statusElement.parentElement.parentElement.classList.remove('from-green-500', 'to-green-600');
                statusElement.parentElement.parentElement.classList.add('from-purple-500', 'to-purple-600');
            }
        }

        // Render participants list
        function renderParticipantsList() {
            const listContainer = document.getElementById('participants-list');
            const emptyState = document.getElementById('empty-state');
            
            if (participants.length === 0) {
                listContainer.classList.add('hidden');
                emptyState.classList.remove('hidden');
                return;
            }
            
            listContainer.classList.remove('hidden');
            emptyState.classList.add('hidden');
            
            listContainer.innerHTML = participants.map(participant => `
                <div class="bg-gradient-to-r from-gray-50 to-white rounded-lg p-4 border border-gray-200 hover:shadow-md transition-shadow">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center flex-1">
                            <div class="text-3xl mr-4">üë§</div>
                            <div class="flex-1">
                                <h4 class="font-bold text-gray-800 text-lg">${participant.name}</h4>
                                <p class="text-sm text-gray-600">${participant.email}</p>
                                <p class="text-sm text-gray-600">üì± ${participant.phone}</p>
                                <div class="flex items-center gap-2 mt-1">
                                    <span class="text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded-full">Usuario: ${participant.username}</span>
                                    <span class="text-xs bg-purple-100 text-purple-700 px-2 py-0.5 rounded-full">Pass: ${participant.password}</span>
                                </div>
                                ${participant.assignedTo ? `
                                    <div class="mt-2 bg-green-50 border border-green-200 rounded-lg p-2">
                                        <p class="text-xs text-green-700 font-semibold">üéÅ Asignado a: ${participant.assignedTo}</p>
                                        <p class="text-xs text-green-600">${participant.assignedToEmail}</p>
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                        <button onclick="deleteParticipant('${participant.__backendId}')" 
                                class="bg-red-500 hover:bg-red-600 text-white font-bold p-3 rounded-lg transition-colors ml-4">
                            <span class="text-xl">üóëÔ∏è</span>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Delete participant
        async function deleteParticipant(backendId) {
            const participant = participants.find(p => p.__backendId === backendId);
            if (!participant) return;
            
            showConfirmModal(
                "¬øEliminar participante?",
                `¬øEst√°s seguro de eliminar a ${participant.name}? Esta acci√≥n no se puede deshacer.`,
                async () => {
                    const result = await window.dataSdk.delete(participant);
                    
                    if (result.isOk) {
                        showToast("Participante eliminado exitosamente.", "success");
                    } else {
                        showToast("Error al eliminar el participante. Intenta nuevamente.", "error");
                    }
                }
            );
        }

        // Perform draw
        async function performDraw() {
            if (isDrawing) return;
            isDrawing = true;
            
            showToast("Realizando sorteo... üé≤", "info");
            
            // Create shuffled array
            const shuffled = [...participants];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            
            // Assign each person to the next one (circular)
            const drawId = generateId();
            const updates = [];
            
            for (let i = 0; i < participants.length; i++) {
                const giver = participants[i];
                const receiver = shuffled[(i + 1) % shuffled.length];
                
                // Make sure no one is assigned to themselves
                if (giver.id === receiver.id) {
                    // Swap with next person
                    const nextIndex = (i + 2) % shuffled.length;
                    [shuffled[(i + 1) % shuffled.length], shuffled[nextIndex]] = 
                    [shuffled[nextIndex], shuffled[(i + 1) % shuffled.length]];
                    
                    const newReceiver = shuffled[(i + 1) % shuffled.length];
                    updates.push({
                        ...giver,
                        assignedTo: newReceiver.name,
                        assignedToEmail: newReceiver.email,
                        drawId: drawId
                    });
                } else {
                    updates.push({
                        ...giver,
                        assignedTo: receiver.name,
                        assignedToEmail: receiver.email,
                        drawId: drawId
                    });
                }
            }
            
            // Update all participants
            for (const update of updates) {
                const result = await window.dataSdk.update(update);
                if (!result.isOk) {
                    showToast("Error al realizar el sorteo. Intenta nuevamente.", "error");
                    isDrawing = false;
                    return;
                }
            }
            
            isDrawing = false;
            showToast("¬°Sorteo realizado exitosamente! üéâ", "success");
        }

        // Check if there are any assignments
        function hasAssignments() {
            return participants.some(p => p.assignedTo);
        }

        // Open add participant modal
        function openAddParticipantModal() {
            document.getElementById('add-participant-modal').classList.remove('hidden');
        }

        // Close add participant modal
        function closeAddParticipantModal() {
            document.getElementById('add-participant-modal').classList.add('hidden');
            document.getElementById('participant-form').reset();
        }

        // Show confirmation modal
        function showConfirmModal(title, message, onConfirm) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center px-4';
            modal.style.zIndex = '2000';
            modal.innerHTML = `
                <div class="bg-white rounded-2xl p-8 max-w-md w-full shadow-2xl fade-in">
                    <div class="text-center mb-6">
                        <div class="text-5xl mb-4">‚ö†Ô∏è</div>
                        <h3 class="text-2xl font-bold text-gray-800 mb-2">${title}</h3>
                        <p class="text-gray-600">${message}</p>
                    </div>
                    <div class="flex gap-3">
                        <button id="modal-cancel" 
                                class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 font-bold py-3 px-6 rounded-lg transition-colors">
                            Cancelar
                        </button>
                        <button id="modal-confirm" 
                                class="flex-1 bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-6 rounded-lg transition-colors">
                            Confirmar
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            modal.querySelector('#modal-cancel').addEventListener('click', () => {
                modal.remove();
            });
            
            modal.querySelector('#modal-confirm').addEventListener('click', () => {
                modal.remove();
                onConfirm();
            });
            
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }

        // Show toast message
        function showToast(message, type) {
            const toast = document.createElement('div');
            toast.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 fade-in ${
                type === 'success' ? 'bg-green-100 text-green-800 border border-green-200' :
                type === 'error' ? 'bg-red-100 text-red-800 border border-red-200' :
                'bg-blue-100 text-blue-800 border border-blue-200'
            }`;
            toast.style.zIndex = '3000';
            toast.textContent = message;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 4000);
        }

        // Generate unique ID
        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }

        // Create sinusoidal garland
        function createGarland() {
            const garlandStrand = document.getElementById('garland-strand');
            garlandStrand.innerHTML = '';
            const width = window.innerWidth;
            const numBranches = Math.floor(width / 25);
            const amplitude = 45;
            const frequency = 3;
            
            const colors = ['red', 'yellow', 'blue', 'green', 'pink', 'orange'];
            
            for (let i = 0; i < numBranches; i++) {
                const x = (i / numBranches) * width;
                const normalizedX = (i / numBranches) * Math.PI * 2 * frequency;
                const y = Math.sin(normalizedX) * amplitude + amplitude + 20;
                
                const branch = document.createElement('div');
                branch.className = 'garland-branch';
                branch.style.left = `${x}px`;
                branch.style.top = `${y}px`;
                branch.style.height = `${15 + Math.random() * 10}px`;
                branch.style.transform = `rotate(${Math.random() * 20 - 10}deg)`;
                
                garlandStrand.appendChild(branch);
                
                if (i % 2 === 0) {
                    const light = document.createElement('div');
                    const randomColor = colors[Math.floor(Math.random() * colors.length)];
                    light.className = `light ${randomColor}`;
                    light.style.left = `${x}px`;
                    light.style.top = `${y + 22}px`;
                    
                    garlandStrand.appendChild(light);
                }
            }
        }

        // Element SDK Configuration
        async function onConfigChange(config) {
            document.getElementById('admin-title').textContent = config.admin_title || defaultConfig.admin_title;
            document.getElementById('event-name').textContent = config.event_name || defaultConfig.event_name;
            document.getElementById('welcome-message').textContent = config.welcome_message || defaultConfig.welcome_message;
            document.getElementById('security-code-label').textContent = config.security_code_label || defaultConfig.security_code_label;
            
            const backgroundColor = config.background_color || defaultConfig.background_color;
            const primaryColor = config.primary_color || defaultConfig.primary_color;
            const secondaryColor = config.secondary_color || defaultConfig.secondary_color;
            const textColor = config.text_color || defaultConfig.text_color;
            const surfaceColor = config.surface_color || defaultConfig.surface_color;
            
            document.body.style.background = `linear-gradient(to bottom right, ${backgroundColor}, #fef3c7)`;
            
            const header = document.querySelector('header');
            if (header) {
                header.style.background = `linear-gradient(to right, ${primaryColor}, ${secondaryColor})`;
            }
            
            const adminCard = document.querySelector('.admin-card');
            if (adminCard) {
                adminCard.style.background = `linear-gradient(135deg, ${primaryColor} 0%, ${secondaryColor} 100%)`;
            }
            
            const textElements = document.querySelectorAll('h1, h2, h3, h4, p, label');
            textElements.forEach(el => {
                if (!el.classList.contains('text-white') && !el.classList.contains('text-gray-300')) {
                    el.style.color = textColor;
                }
            });
            
            const surfaces = document.querySelectorAll('.bg-white');
            surfaces.forEach(surface => {
                surface.style.backgroundColor = surfaceColor;
            });
        }

        function mapToCapabilities(config) {
            return {
                recolorables: [
                    {
                        get: () => config.background_color || defaultConfig.background_color,
                        set: (value) => {
                            config.background_color = value;
                            if (window.elementSdk) {
                                window.elementSdk.setConfig({ background_color: value });
                            }
                        }
                    },
                    {
                        get: () => config.surface_color || defaultConfig.surface_color,
                        set: (value) => {
                            config.surface_color = value;
                            if (window.elementSdk) {
                                window.elementSdk.setConfig({ surface_color: value });
                            }
                        }
                    },
                    {
                        get: () => config.text_color || defaultConfig.text_color,
                        set: (value) => {
                            config.text_color = value;
                            if (window.elementSdk) {
                                window.elementSdk.setConfig({ text_color: value });
                            }
                        }
                    },
                    {
                        get: () => config.primary_color || defaultConfig.primary_color,
                        set: (value) => {
                            config.primary_color = value;
                            if (window.elementSdk) {
                                window.elementSdk.setConfig({ primary_color: value });
                            }
                        }
                    },
                    {
                        get: () => config.secondary_color || defaultConfig.secondary_color,
                        set: (value) => {
                            config.secondary_color = value;
                            if (window.elementSdk) {
                                window.elementSdk.setConfig({ secondary_color: value });
                            }
                        }
                    }
                ],
                borderables: [],
                fontEditable: undefined,
                fontSizeable: undefined
            };
        }

        function mapToEditPanelValues(config) {
            return new Map([
                ["admin_title", config.admin_title || defaultConfig.admin_title],
                ["event_name", config.event_name || defaultConfig.event_name],
                ["welcome_message", config.welcome_message || defaultConfig.welcome_message],
                ["security_code_label", config.security_code_label || defaultConfig.security_code_label]
            ]);
        }

        // Initialize SDKs
        async function initializeApp() {
            createGarland();
            
            if (window.elementSdk) {
                window.elementSdk.init({
                    defaultConfig,
                    onConfigChange,
                    mapToCapabilities,
                    mapToEditPanelValues
                });
            }
            
            if (window.dataSdk) {
                const result = await window.dataSdk.init(dataHandler);
                if (!result.isOk) {
                    console.error("Failed to initialize Data SDK");
                }
            }
        }
        
        window.addEventListener('resize', () => {
            const garlandStrand = document.getElementById('garland-strand');
            garlandStrand.innerHTML = '';
            createGarland();
        });

        initializeApp();
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9a24d0da44039530',t:'MTc2Mzc3NjY0NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
